(()=>{function u(n,t){let r=t.method?t.method.toUpperCase():"GET";if(r!=="GET"&&r!=="HEAD"){let d=document.querySelector('meta[name="csrf-token"]')?document.querySelector('meta[name="csrf-token"]').getAttribute("content"):"";t.headers={...t.headers,"X-CSRF-Token":d}}return fetch(n,t).then(a=>{if(!a.ok)throw new Error("Network response was not ok: "+a.statusText);let d=a.headers.get("Content-Type");return d.includes("application/json")?a.json():d.includes("text/javascript")?a.text().then(l=>(0,eval)(l)):d.includes("text/html")?a.text():a.blob()})}function h(n){let t=document.querySelector('meta[name="sc-path"]');if(t){let r=t.content;if(r)return`/${r}${n}`}return n}window.StoreConnect=window.StoreConnect||{};window.StoreConnect.ObserverCallbacks=window.StoreConnect.ObserverCallbacks||[];document.addEventListener("DOMContentLoaded",C);function g(n){window.StoreConnect.ObserverCallbacks.push(n)}function C(){window.StoreConnect.Observer||(window.StoreConnect.Observer=new MutationObserver(n=>{n.forEach(t=>{t.addedNodes.forEach(r=>{r.nodeType===Node.ELEMENT_NODE&&w(r,"mutation")})})}),window.StoreConnect.Observer.observe(document.body,{childList:!0,subtree:!0}),w(document,"initial load"))}function w(n,t){window.StoreConnect.ObserverCallbacks.forEach(r=>r(n))}g(E);function E(n){[...n.querySelectorAll("[data-checkout-address-container]")].forEach(t=>{S(t)})}function S(n){let t=document.getElementById(n.getAttribute("data-country-id")),r=n.getAttribute("data-state-id"),a=n.getAttribute("data-address-type"),d=document.getElementById(n.getAttribute("data-billing-same-id"));t&&(m(t.value),t.addEventListener("change",function(o){let e=o.target.value;m(e),f(e)})),d&&d.addEventListener("change",()=>{t&&f(t.value)}),t&&f(t.value);function l(){return d?d.checked:!1}function p(o){[...document.querySelectorAll("[data-required-fields-form] input, [data-required-fields-form] select")].forEach(e=>{let s=e.name;if(s&&e.name.includes(a)){let i=o.includes(s);if(a==="billing"&&l()&&(i=!1),s.includes("address_lines")){let c=e.form;Array.from(c.querySelectorAll(`input[name="${e.name}"]`)).indexOf(e)===0&&(i=o.includes(s.replace("[]","")))}i?(e.required=!0,e.dataset.required=!0,e.labels&&e.labels.forEach(c=>{c.dataset.required=!0})):(e.required=!1,delete e.dataset.required,e.labels&&e.labels.forEach(c=>{delete c.dataset.required}))}})}function f(o){u(h("/checkout/required_fields"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({country_id:o,billing_same_as_shipping:l()}).toString()}).then(e=>{p(e)}).catch(e=>{console.error("Error updating required fields:",e)})}function m(o){if(o==="")return!1;u(h("/checkout/find_states"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({country_id:o}).toString()}).then(e=>{y(e)}).catch(e=>{console.error("Error updating states:",e)})}function y(o){let e=document.getElementById(r);if(e){let s=e.getAttribute("data-selected");e.options.length=0,o.unshift(["",e.getAttribute("placeholder")]),o.forEach(i=>{let c=document.createElement("option"),b=document.createTextNode(i[1]);c.appendChild(b),c.setAttribute("value",i[0]),i[0]===s&&c.setAttribute("selected",!0),e.appendChild(c)})}}}})();
