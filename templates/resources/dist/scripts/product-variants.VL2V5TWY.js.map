{
  "version": 3,
  "sources": ["../../src/scripts/theme/loader.js", "../../src/scripts/theme/utils/init.js", "../../src/scripts/packs/product-variants.js"],
  "sourcesContent": ["function Loader(settings) {\n  const target = settings.target || null\n  const contextual = settings.contextual\n\n  return {\n    on: () => stopLoader(target),\n    off: () => startLoader(target, contextual),\n  }\n}\n\nexport function startLoader(container, contextual = false) {\n  const loader = getLoader(container)\n\n  if (loader) {\n    activate(loader, contextual)\n  } else {\n    createLoader(container, contextual)\n  }\n}\n\nexport function stopLoader(container) {\n  const loader = getLoader(container)\n\n  if (loader === null) return\n  loader.classList.remove('is-active')\n}\n\nfunction getLoader(target) {\n  const origin = target || document.querySelector('body')\n  return origin.querySelector('[data-loader]')\n}\n\nfunction activate(loader, contextual = false) {\n  if (loader.classList.contains('Loader')) {\n    loader.classList.add('is-active')\n  } else if (contextual) {\n    loader.classList.add('Loader', 'is-active', 'is-contextual')\n  } else {\n    loader.classList.add('Loader', 'is-active')\n  }\n}\n\nfunction createLoader(target, contextual = false) {\n  const loader = document.createElement('div')\n  const spinner = createSpinner()\n  const destination = target || document.querySelector('body')\n\n  loader.setAttribute('data-loader', '')\n  loader.classList.add('Loader', 'is-active')\n  if (contextual) loader.classList.add('is-contextual')\n  destination.prepend(loader)\n  loader.append(spinner)\n}\n\nfunction createSpinner() {\n  const url = 'http://www.w3.org/2000/svg'\n  const svg = document.createElementNS(url, 'svg')\n  const circle = document.createElementNS(url, 'circle')\n\n  svg.setAttribute('viewBox', '0 0 50 50')\n  svg.classList.add('spinner')\n  circle.setAttribute('cx', '25')\n  circle.setAttribute('cy', '25')\n  circle.setAttribute('r', '20')\n  circle.setAttribute('fill', 'none')\n  circle.setAttribute('stroke-width', '5')\n  circle.classList.add('path')\n  svg.appendChild(circle)\n\n  return svg\n}\n\nexport default Loader\n", "// This script establishes a MutationObserver to detect changes in the DOM and run callbacks when changes are detected.\n// It tries to be efficient about this by establishing only one obeserver and running all callbacks once on each new node.\n// There is a limitation of this mechanism: if a node contains a script that has not before been added to the dom,\n// and it calls onDomChange, its callback won't be run against anything until the next mutation.\n// To work around this, ensure the script is loaded in the initial page load or a previous fetch.\n\nwindow.StoreConnect = window.StoreConnect || {}\nwindow.StoreConnect.ObserverCallbacks = window.StoreConnect.ObserverCallbacks || []\n\ndocument.addEventListener('DOMContentLoaded', establishObserver)\n\nexport function onDomChange(initCallback) {\n  window.StoreConnect.ObserverCallbacks.push(initCallback)\n}\n\nfunction establishObserver() {\n  if (window.StoreConnect.Observer) return\n\n  window.StoreConnect.Observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      mutation.addedNodes.forEach((node) => {\n        if (node.nodeType === Node.ELEMENT_NODE) {\n          runCallbacks(node, 'mutation')\n        }\n      })\n    })\n  })\n\n  window.StoreConnect.Observer.observe(document.body, { childList: true, subtree: true })\n\n  runCallbacks(document, 'initial load')\n}\n\nfunction runCallbacks(node, _context) {\n  window.StoreConnect.ObserverCallbacks.forEach((callback) => callback(node))\n}\n", "import { startLoader, stopLoader } from '../theme/loader'\nimport { onDomChange } from '../theme/utils/init'\n\nonDomChange(init)\n\nwindow.addEventListener('popstate', popVariantPathFromHistory)\n\nlet clearButton, resetButton, selectionPrompt, variantSelector\n\nfunction init(node) {\n  const variantOptions = [...node.querySelectorAll('[data-variant-option]')]\n\n  if (variantOptions.length == 0) return\n\n  variantSelector = variantOptions[0].closest('[data-variant-option-selector]')\n\n  clearButton = variantSelector.querySelector('[data-variant-clear-button]')\n  resetButton = variantSelector.querySelector('[data-variant-reset-button]')\n  selectionPrompt = variantSelector.querySelector('[data-variant-selection-prompt]')\n\n  // Event listeners\n  variantOptions.map((option) => {\n    option.addEventListener('change', (event) => {\n      configureOptions(event.target)\n    })\n  })\n\n  variantSelector.querySelectorAll('[data-variant-type] select').forEach((selectElem) => {\n    selectElem.addEventListener('change', (event) => {\n      configureOptions(event.target)\n    })\n  })\n\n  if (clearButton) {\n    clearButton.addEventListener('click', () => {\n      clearSelectedOptions()\n      if (resetButton) resetButton.classList.remove('is-hidden')\n      if (selectionPrompt) selectionPrompt.classList.remove('is-hidden')\n    })\n  }\n\n  if (resetButton) {\n    resetButton.addEventListener('click', () => {\n      resetSelectedOptions()\n      configureOptions()\n      resetButton.classList.add('is-hidden')\n      if (selectionPrompt) selectionPrompt.classList.remove('is-hidden')\n    })\n  }\n\n  configureOptions()\n}\n\nfunction configureOptions(target = null) {\n  if (!window.variantData) return\n\n  const targetType = target ? target.dataset.type : null\n\n  const selectedOptions = getSelectedOptions()\n  if (Object.keys(selectedOptions).length == 0) return\n\n  const types = window.variantData['types']\n  const products = window.variantData['products'].filter((product) => {\n    for (const selectedOption of selectedOptions) {\n      if (product[selectedOption.type] != selectedOption.value) {\n        return false\n      }\n    }\n    return true\n  })\n\n  const enabledValuesByType = {}\n  for (const product of products) {\n    for (const availableType of types) {\n      if (target && targetType == availableType) continue\n      enabledValuesByType[availableType] = enabledValuesByType[availableType] || new Set()\n      enabledValuesByType[availableType].add(product[availableType])\n    }\n  }\n\n  if (types.length > 1) {\n    for (const enabledType of Object.keys(enabledValuesByType)) {\n      variantSelector\n        .querySelectorAll(`[data-variant-type=\"${enabledType}\"] [data-variant-option]`)\n        .forEach((optElem) => {\n          disable(optElem, !enabledValuesByType[enabledType].has(optElem.value))\n        })\n    }\n  }\n\n  const selectedProduct = checkForSelectedProduct(selectedOptions)\n  if (selectedProduct) {\n    load(selectedProduct.path)\n  } else {\n    if (resetButton) resetButton.classList.remove('is-hidden')\n    if (selectionPrompt) selectionPrompt.classList.add('is-hidden')\n  }\n}\n\nfunction getSelectedOptions() {\n  const selectedOptions = []\n  variantSelector\n    .querySelectorAll('[data-variant-type] [data-variant-option]')\n    .forEach((option) => {\n      if (option.selected || option.checked) {\n        selectedOptions.push({ type: option.dataset.type, value: option.value })\n      }\n    })\n  return selectedOptions\n}\n\nfunction clearSelectedOptions() {\n  const path = clearButton.dataset.clearPath\n  if (path) {\n    load(path)\n  } else {\n    variantSelector\n      .querySelectorAll('[data-variant-type] [data-variant-option]')\n      .forEach((option) => {\n        if (option.selected != undefined) {\n          const select = option.closest('select')\n          if (select) {\n            const options = select.querySelectorAll('option')\n            if (options.length > 0) options[0].selected = true\n          }\n        }\n        if (option.checked != undefined) {\n          option.checked = false\n        }\n        disable(option, false)\n      })\n  }\n}\n\nfunction resetSelectedOptions() {\n  variantSelector\n    .querySelectorAll('[data-variant-type] [data-variant-option]')\n    .forEach((option) => {\n      if (option.selected != undefined) {\n        option.selected = option.dataset.selected == 'true'\n      }\n      if (option.checked != undefined) {\n        option.checked = option.dataset.checked == 'true'\n      }\n      disable(option, false)\n    })\n}\n\nfunction checkForSelectedProduct(selectedOptions) {\n  const types = window.variantData['types']\n  const products = window.variantData['products']\n\n  for (const type of types) {\n    if (!selectedOptions.find((option) => option.type == type)) {\n      return false\n    }\n  }\n\n  const selectedProduct = products.find((product) => {\n    for (const option of selectedOptions) {\n      if (product[option.type] != option.value) {\n        return false\n      }\n    }\n    return true\n  })\n\n  return selectedProduct\n}\n\nfunction load(path, callback) {\n  if (window.location.pathname != path) {\n    if (path == null) {\n      path = window.location.pathname\n    }\n\n    const element = document.querySelector('[data-remote-target=\"product\"]')\n\n    startLoader(element)\n\n    fetch(path, {\n      headers: {\n        Accept: 'application/json',\n      },\n    })\n      .then((response) => {\n        return response.json()\n      })\n      .then((json) => {\n        pushVariantPathToHistory(path)\n\n        if (element) element.innerHTML = json['html']\n        callback && callback()\n      })\n      .catch((error) => {\n        console.log(error)\n      })\n      .finally(() => {\n        stopLoader(element)\n      })\n  }\n}\n\nfunction pushVariantPathToHistory(path) {\n  if (window.location.pathname === path) {\n    return\n  }\n  window.history.pushState(path, null, path)\n}\n\nfunction popVariantPathFromHistory(_event) {\n  load(null)\n}\n\nfunction disable(option, bool) {\n  option.disabled = bool\n}\n"],
  "mappings": "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",
  "names": []
}
