{
  "version": 3,
  "sources": ["../../src/scripts/theme/utils/init.js", "../../node_modules/js-cookie/dist/js.cookie.mjs", "../../src/scripts/packs/payments.js"],
  "sourcesContent": ["// This script establishes a MutationObserver to detect changes in the DOM and run callbacks when changes are detected.\n// It tries to be efficient about this by establishing only one obeserver and running all callbacks once on each new node.\n// There is a limitation of this mechanism: if a node contains a script that has not before been added to the dom,\n// and it calls onDomChange, its callback won't be run against anything until the next mutation.\n// To work around this, ensure the script is loaded in the initial page load or a previous fetch.\n\nwindow.StoreConnect = window.StoreConnect || {}\nwindow.StoreConnect.ObserverCallbacks = window.StoreConnect.ObserverCallbacks || []\n\ndocument.addEventListener('DOMContentLoaded', establishObserver)\n\nexport function onDomChange(initCallback) {\n  window.StoreConnect.ObserverCallbacks.push(initCallback)\n}\n\nfunction establishObserver() {\n  if (window.StoreConnect.Observer) return\n\n  window.StoreConnect.Observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      mutation.addedNodes.forEach((node) => {\n        if (node.nodeType === Node.ELEMENT_NODE) {\n          runCallbacks(node, 'mutation')\n        }\n      })\n    })\n  })\n\n  window.StoreConnect.Observer.observe(document.body, { childList: true, subtree: true })\n\n  runCallbacks(document, 'initial load')\n}\n\nfunction runCallbacks(node, _context) {\n  window.StoreConnect.ObserverCallbacks.forEach((callback) => callback(node))\n}\n", "/*! js-cookie v3.0.5 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (name, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    name = encodeURIComponent(name)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      name + '=' + converter.write(value, name) + stringifiedAttributes)\n  }\n\n  function get (name) {\n    if (typeof document === 'undefined' || (arguments.length && !name)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var found = decodeURIComponent(parts[0]);\n        jar[found] = converter.read(value, found);\n\n        if (name === found) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return name ? jar[name] : jar\n  }\n\n  return Object.create(\n    {\n      set,\n      get,\n      remove: function (name, attributes) {\n        set(\n          name,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport { api as default };\n", "import { onDomChange } from '../theme/utils/init'\nimport Cookie from 'js-cookie'\nwindow.StoreConnect = window.StoreConnect || {}\n\n// Update checkout summary panel\nonDomChange((node) => {\n  if (!node.querySelector('[data-checkout-summary]')) {\n    return\n  }\n\n  resetPaymentCookieIfNecessary()\n\n  const tabTriggers = node.querySelectorAll('[data-tab-trigger]')\n\n  ;[...tabTriggers].map((tab) => {\n    tab.addEventListener('click', (event) => {\n      const providerId = event.target.getAttribute('data-tab-trigger')\n\n      if (providerId) {\n        showPaymentForm(providerId)\n      }\n    })\n  })\n\n  let currentProviderId = Cookie.get('last-used-payment-provider')\n\n  if (currentProviderId && providerIdTabExists(currentProviderId)) {\n    showPaymentForm(currentProviderId)\n  } else {\n    currentProviderId = null\n    // If there is no last used provider, we'll show the first one if it is available\n    const paymentProviders = document.querySelector(\"section[data-tabs='payment']\")\n    if (paymentProviders) {\n      if (paymentProviders.querySelector('[data-tab]')) {\n        currentProviderId = paymentProviders.querySelector('[data-tab]').getAttribute('data-tab')\n        if (currentProviderId) {\n          showPaymentForm(currentProviderId)\n        }\n      }\n    }\n  }\n\n  // If no payment provider is selected,\n  // e.g. vouchers/credit covers the entire order\n  // we still need to setTotalPayable + setTotalTax\n  if (!currentProviderId) {\n    activateSurcharge()\n  }\n})\n\n// Once a payment is processed, reset the payment provider cookie;\n// Or if the user starts the checkout process again.\n// The data-reset-cookie-checkout attribute should appear on these pages.\nfunction resetPaymentCookieIfNecessary() {\n  if (document.querySelector('[data-reset-cookie-checkout]')) {\n    Cookie.remove('last-used-payment-provider')\n  }\n}\n\nfunction providerIdTabExists(providerId) {\n  return document.querySelector(`[data-tab='${providerId}']`)\n}\n\nfunction showPaymentForm(providerId) {\n  document.querySelectorAll('[data-tab]').forEach((tab) => tab.classList.add('sc-hide'))\n  document\n    .querySelectorAll('[data-tab-trigger]')\n    .forEach((tab) => tab.classList.remove('is-active'))\n\n  const tab = document.querySelector(`[data-tab='${providerId}']`)\n  const trigger = document.querySelector(`[data-tab-trigger='${providerId}']`)\n\n  // Store the selected payment provider for 1 day\n  Cookie.set('last-used-payment-provider', providerId, { expires: 1 })\n\n  if (tab) {\n    tab.classList.remove('sc-hide')\n  }\n  if (trigger) {\n    trigger.classList.add('is-active')\n  }\n  activateSurcharge(providerId)\n}\n\n// providerId may be null if there is no payment provider selected\n// e.g. vouchers/credit covers the entire order\nfunction activateSurcharge(providerId) {\n  const totalPayableElem = document.querySelector('[data-order-cart-total-payable]')\n  const totalTaxElem = document.querySelector('[data-order-tax-amount]')\n\n  document.querySelectorAll(`[data-surcharge-id]`).forEach((elem) => elem.classList.add('sc-hide'))\n\n  let elem = null\n  if (providerId) {\n    const selector = `[data-surcharge-id=\"${providerId}\"]`\n    document.querySelectorAll(selector).forEach((elem) => elem.classList.remove('sc-hide'))\n\n    elem = document.querySelector(selector)\n  }\n\n  if (elem) {\n    setTotalPayable(elem.getAttribute('data-surcharge-cart-total-payable'))\n    setTotalTax(elem.getAttribute('data-surcharge-cart-total-tax'))\n  } else {\n    if (totalPayableElem) {\n      setTotalPayable(totalPayableElem.getAttribute('data-order-cart-total-payable'))\n    }\n\n    if (totalTaxElem) {\n      setTotalTax(totalTaxElem.getAttribute('data-order-tax-amount'))\n    }\n  }\n}\n\nfunction setTotalPayable(amount) {\n  document.querySelectorAll('[data-order-cart-total-payable]').forEach((elem) => {\n    elem.innerHTML = amount\n  })\n}\n\nfunction setTotalTax(amount) {\n  document.querySelectorAll('[data-order-tax-amount]').forEach((elem) => {\n    elem.innerHTML = amount\n  })\n}\n"],
  "mappings": "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",
  "names": ["converter", "tab", "elem"]
}
