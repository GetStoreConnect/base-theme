(()=>{var O=Object.create;var R=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,Q=Object.prototype.hasOwnProperty;var K=(d,e)=>()=>(e||d((e={exports:{}}).exports,e),e.exports);var J=(d,e,r,l)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of G(e))!Q.call(d,n)&&n!==r&&R(d,n,{get:()=>e[n],enumerable:!(l=X(e,n))||l.enumerable});return d};var W=(d,e,r)=>(r=d!=null?O(z(d)):{},J(e||!d||!d.__esModule?R(r,"default",{value:d,enumerable:!0}):r,d));var I=K((A,x)=>{(function(){var d=this;(function(){(function(){this.Rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:{selector:"button[data-remote]:not([form]), button[data-confirm]:not([form])",exclude:"form button"},inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form:not([data-turbo=true])",formInputClickSelector:"form:not([data-turbo=true]) input[type=submit], form:not([data-turbo=true]) input[type=image], form:not([data-turbo=true]) button[type=submit], form:not([data-turbo=true]) button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",formDisableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",formEnableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]"}}).call(this)}).call(d);var e=d.Rails;(function(){(function(){var r;r=null,e.loadCSPNonce=function(){var l;return r=(l=document.querySelector("meta[name=csp-nonce]"))!=null?l.content:void 0},e.cspNonce=function(){return r??e.loadCSPNonce()}}).call(this),function(){var r,l;l=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector,e.matches=function(n,i){return i.exclude!=null?l.call(n,i.selector)&&!l.call(n,i.exclude):l.call(n,i)},r="_ujsData",e.getData=function(n,i){var o;return(o=n[r])!=null?o[i]:void 0},e.setData=function(n,i,o){return n[r]==null&&(n[r]={}),n[r][i]=o},e.$=function(n){return Array.prototype.slice.call(document.querySelectorAll(n))}}.call(this),function(){var r,l,n;r=e.$,n=e.csrfToken=function(){var i;return i=document.querySelector("meta[name=csrf-token]"),i&&i.content},l=e.csrfParam=function(){var i;return i=document.querySelector("meta[name=csrf-param]"),i&&i.content},e.CSRFProtection=function(i){var o;if(o=n(),o!=null)return i.setRequestHeader("X-CSRF-Token",o)},e.refreshCSRFTokens=function(){var i,o;if(o=n(),i=l(),o!=null&&i!=null)return r('form input[name="'+i+'"]').forEach(function(p){return p.value=o})}}.call(this),function(){var r,l,n,i;n=e.matches,r=window.CustomEvent,typeof r!="function"&&(r=function(o,p){var u;return u=document.createEvent("CustomEvent"),u.initCustomEvent(o,p.bubbles,p.cancelable,p.detail),u},r.prototype=window.Event.prototype,i=r.prototype.preventDefault,r.prototype.preventDefault=function(){var o;return o=i.call(this),this.cancelable&&!this.defaultPrevented&&Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}}),o}),l=e.fire=function(o,p,u){var t;return t=new r(p,{bubbles:!0,cancelable:!0,detail:u}),o.dispatchEvent(t),!t.defaultPrevented},e.stopEverything=function(o){return l(o.target,"ujs:everythingStopped"),o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation()},e.delegate=function(o,p,u,t){return o.addEventListener(u,function(s){var c;for(c=s.target;!(!(c instanceof Element)||n(c,p));)c=c.parentNode;if(c instanceof Element&&t.call(c,s)===!1)return s.preventDefault(),s.stopPropagation()})}}.call(this),function(){var r,l,n,i,o,p,u;i=e.cspNonce,l=e.CSRFProtection,o=e.fire,r={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},e.ajax=function(t){var s;if(t=p(t),s=n(t,function(){var c,b;return b=u((c=s.response)!=null?c:s.responseText,s.getResponseHeader("Content-Type")),Math.floor(s.status/100)===2?typeof t.success=="function"&&t.success(b,s.statusText,s):typeof t.error=="function"&&t.error(b,s.statusText,s),typeof t.complete=="function"?t.complete(s,s.statusText):void 0}),t.beforeSend!=null&&!t.beforeSend(s,t))return!1;if(s.readyState===XMLHttpRequest.OPENED)return s.send(t.data)},p=function(t){return t.url=t.url||location.href,t.type=t.type.toUpperCase(),t.type==="GET"&&t.data&&(t.url.indexOf("?")<0?t.url+="?"+t.data:t.url+="&"+t.data),r[t.dataType]==null&&(t.dataType="*"),t.accept=r[t.dataType],t.dataType!=="*"&&(t.accept+=", */*; q=0.01"),t},n=function(t,s){var c;return c=new XMLHttpRequest,c.open(t.type,t.url,!0),c.setRequestHeader("Accept",t.accept),typeof t.data=="string"&&c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.crossDomain||(c.setRequestHeader("X-Requested-With","XMLHttpRequest"),l(c)),c.withCredentials=!!t.withCredentials,c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE)return s(c)},c},u=function(t,s){var c,b;if(typeof t=="string"&&typeof s=="string"){if(s.match(/\bjson\b/))try{t=JSON.parse(t)}catch{}else if(s.match(/\b(?:java|ecma)script\b/))b=document.createElement("script"),b.setAttribute("nonce",i()),b.text=t,document.head.appendChild(b).parentNode.removeChild(b);else if(s.match(/\b(xml|html|svg)\b/)){c=new DOMParser,s=s.replace(/;.+/,"");try{t=c.parseFromString(t,s)}catch{}}}return t},e.href=function(t){return t.href},e.isCrossDomain=function(t){var s,c,b;c=document.createElement("a"),c.href=location.href,b=document.createElement("a");try{return b.href=t,!((!b.protocol||b.protocol===":")&&!b.host||c.protocol+"//"+c.host==b.protocol+"//"+b.host)}catch(h){return s=h,!0}}}.call(this),function(){var r,l;r=e.matches,l=function(n){return Array.prototype.slice.call(n)},e.serializeElement=function(n,i){var o,p;return o=[n],r(n,"form")&&(o=l(n.elements)),p=[],o.forEach(function(u){if(!(!u.name||u.disabled)&&!r(u,"fieldset[disabled] *")){if(r(u,"select"))return l(u.options).forEach(function(t){if(t.selected)return p.push({name:u.name,value:t.value})});if(u.checked||["radio","checkbox","submit"].indexOf(u.type)===-1)return p.push({name:u.name,value:u.value})}}),i&&p.push(i),p.map(function(u){return u.name!=null?encodeURIComponent(u.name)+"="+encodeURIComponent(u.value):u}).join("&")},e.formElements=function(n,i){return r(n,"form")?l(n.elements).filter(function(o){return r(o,i)}):l(n.querySelectorAll(i))}}.call(this),function(){var r,l,n;l=e.fire,n=e.stopEverything,e.handleConfirm=function(i){if(!r(this))return n(i)},e.confirm=function(i,o){return confirm(i)},r=function(i){var o,p,u;if(u=i.getAttribute("data-confirm"),!u)return!0;if(o=!1,l(i,"confirm")){try{o=e.confirm(u,i)}catch{}p=l(i,"confirm:complete",[o])}return o&&p}}.call(this),function(){var r,l,n,i,o,p,u,t,s,c,b,h;c=e.matches,t=e.getData,b=e.setData,h=e.stopEverything,u=e.formElements,e.handleDisabledElement=function(a){var f;if(f=this,f.disabled)return h(a)},e.enableElement=function(a){var f;if(a instanceof Event){if(s(a))return;f=a.target}else f=a;if(c(f,e.linkDisableSelector))return p(f);if(c(f,e.buttonDisableSelector)||c(f,e.formEnableSelector))return i(f);if(c(f,e.formSubmitSelector))return o(f)},e.disableElement=function(a){var f;if(f=a instanceof Event?a.target:a,c(f,e.linkDisableSelector))return n(f);if(c(f,e.buttonDisableSelector)||c(f,e.formDisableSelector))return r(f);if(c(f,e.formSubmitSelector))return l(f)},n=function(a){var f;if(!t(a,"ujs:disabled"))return f=a.getAttribute("data-disable-with"),f!=null&&(b(a,"ujs:enable-with",a.innerHTML),a.innerHTML=f),a.addEventListener("click",h),b(a,"ujs:disabled",!0)},p=function(a){var f;return f=t(a,"ujs:enable-with"),f!=null&&(a.innerHTML=f,b(a,"ujs:enable-with",null)),a.removeEventListener("click",h),b(a,"ujs:disabled",null)},l=function(a){return u(a,e.formDisableSelector).forEach(r)},r=function(a){var f;if(!t(a,"ujs:disabled"))return f=a.getAttribute("data-disable-with"),f!=null&&(c(a,"button")?(b(a,"ujs:enable-with",a.innerHTML),a.innerHTML=f):(b(a,"ujs:enable-with",a.value),a.value=f)),a.disabled=!0,b(a,"ujs:disabled",!0)},o=function(a){return u(a,e.formEnableSelector).forEach(i)},i=function(a){var f;return f=t(a,"ujs:enable-with"),f!=null&&(c(a,"button")?a.innerHTML=f:a.value=f,b(a,"ujs:enable-with",null)),a.disabled=!1,b(a,"ujs:disabled",null)},s=function(a){var f,m;return m=(f=a.detail)!=null?f[0]:void 0,m?.getResponseHeader("X-Xhr-Redirect")!=null}}.call(this),function(){var r;r=e.stopEverything,e.handleMethod=function(l){var n,i,o,p,u,t,s;if(t=this,s=t.getAttribute("data-method"),!!s)return u=e.href(t),i=e.csrfToken(),n=e.csrfParam(),o=document.createElement("form"),p="<input name='_method' value='"+s+"' type='hidden' />",n!=null&&i!=null&&!e.isCrossDomain(u)&&(p+="<input name='"+n+"' value='"+i+"' type='hidden' />"),p+='<input type="submit" />',o.method="post",o.action=u,o.target=t.target,o.innerHTML=p,o.style.display="none",document.body.appendChild(o),o.querySelector('[type="submit"]').click(),r(l)}}.call(this),function(){var r,l,n,i,o,p,u,t,s,c=[].slice;p=e.matches,n=e.getData,t=e.setData,l=e.fire,s=e.stopEverything,r=e.ajax,i=e.isCrossDomain,u=e.serializeElement,o=function(b){var h;return h=b.getAttribute("data-remote"),h!=null&&h!=="false"},e.handleRemote=function(b){var h,a,f,m,y,v,w;return m=this,o(m)?l(m,"ajax:before")?(w=m.getAttribute("data-with-credentials"),f=m.getAttribute("data-type")||"script",p(m,e.formSubmitSelector)?(h=n(m,"ujs:submit-button"),y=n(m,"ujs:submit-button-formmethod")||m.method,v=n(m,"ujs:submit-button-formaction")||m.getAttribute("action")||location.href,y.toUpperCase()==="GET"&&(v=v.replace(/\?.*$/,"")),m.enctype==="multipart/form-data"?(a=new FormData(m),h!=null&&a.append(h.name,h.value)):a=u(m,h),t(m,"ujs:submit-button",null),t(m,"ujs:submit-button-formmethod",null),t(m,"ujs:submit-button-formaction",null)):p(m,e.buttonClickSelector)||p(m,e.inputChangeSelector)?(y=m.getAttribute("data-method"),v=m.getAttribute("data-url"),a=u(m,m.getAttribute("data-params"))):(y=m.getAttribute("data-method"),v=e.href(m),a=m.getAttribute("data-params")),r({type:y||"GET",url:v,data:a,dataType:f,beforeSend:function(S,U){return l(m,"ajax:beforeSend",[S,U])?l(m,"ajax:send",[S]):(l(m,"ajax:stopped"),!1)},success:function(){var S;return S=1<=arguments.length?c.call(arguments,0):[],l(m,"ajax:success",S)},error:function(){var S;return S=1<=arguments.length?c.call(arguments,0):[],l(m,"ajax:error",S)},complete:function(){var S;return S=1<=arguments.length?c.call(arguments,0):[],l(m,"ajax:complete",S)},crossDomain:i(v),withCredentials:w!=null&&w!=="false"}),s(b)):(l(m,"ajax:stopped"),!1):!0},e.formSubmitButtonClick=function(b){var h,a;if(h=this,a=h.form,!!a)return h.name&&t(a,"ujs:submit-button",{name:h.name,value:h.value}),t(a,"ujs:formnovalidate-button",h.formNoValidate),t(a,"ujs:submit-button-formaction",h.getAttribute("formaction")),t(a,"ujs:submit-button-formmethod",h.getAttribute("formmethod"))},e.preventInsignificantClick=function(b){var h,a,f,m,y,v;if(f=this,y=(f.getAttribute("data-method")||"GET").toUpperCase(),h=f.getAttribute("data-params"),m=b.metaKey||b.ctrlKey,a=m&&y==="GET"&&!h,v=b.button!=null&&b.button!==0,v||a)return b.stopImmediatePropagation()}}.call(this),function(){var r,l,n,i,o,p,u,t,s,c,b,h,a,f,m;if(p=e.fire,n=e.delegate,t=e.getData,r=e.$,m=e.refreshCSRFTokens,l=e.CSRFProtection,a=e.loadCSPNonce,o=e.enableElement,i=e.disableElement,c=e.handleDisabledElement,s=e.handleConfirm,f=e.preventInsignificantClick,h=e.handleRemote,u=e.formSubmitButtonClick,b=e.handleMethod,typeof jQuery<"u"&&jQuery!==null&&jQuery.ajax!=null){if(jQuery.rails)throw new Error("If you load both jquery_ujs and rails-ujs, use rails-ujs only.");jQuery.rails=e,jQuery.ajaxPrefilter(function(y,v,w){if(!y.crossDomain)return l(w)})}e.start=function(){if(window._rails_loaded)throw new Error("rails-ujs has already been loaded!");return window.addEventListener("pageshow",function(){return r(e.formEnableSelector).forEach(function(y){if(t(y,"ujs:disabled"))return o(y)}),r(e.linkDisableSelector).forEach(function(y){if(t(y,"ujs:disabled"))return o(y)})}),n(document,e.linkDisableSelector,"ajax:complete",o),n(document,e.linkDisableSelector,"ajax:stopped",o),n(document,e.buttonDisableSelector,"ajax:complete",o),n(document,e.buttonDisableSelector,"ajax:stopped",o),n(document,e.linkClickSelector,"click",f),n(document,e.linkClickSelector,"click",c),n(document,e.linkClickSelector,"click",s),n(document,e.linkClickSelector,"click",i),n(document,e.linkClickSelector,"click",h),n(document,e.linkClickSelector,"click",b),n(document,e.buttonClickSelector,"click",f),n(document,e.buttonClickSelector,"click",c),n(document,e.buttonClickSelector,"click",s),n(document,e.buttonClickSelector,"click",i),n(document,e.buttonClickSelector,"click",h),n(document,e.inputChangeSelector,"change",c),n(document,e.inputChangeSelector,"change",s),n(document,e.inputChangeSelector,"change",h),n(document,e.formSubmitSelector,"submit",c),n(document,e.formSubmitSelector,"submit",s),n(document,e.formSubmitSelector,"submit",h),n(document,e.formSubmitSelector,"submit",function(y){return setTimeout(function(){return i(y)},13)}),n(document,e.formSubmitSelector,"ajax:send",i),n(document,e.formSubmitSelector,"ajax:complete",o),n(document,e.formInputClickSelector,"click",f),n(document,e.formInputClickSelector,"click",c),n(document,e.formInputClickSelector,"click",s),n(document,e.formInputClickSelector,"click",u),document.addEventListener("DOMContentLoaded",m),document.addEventListener("DOMContentLoaded",a),window._rails_loaded=!0},window.Rails===e&&p(document,"rails:attachBindings")&&e.start()}.call(this)}).call(this),typeof x=="object"&&x.exports?x.exports=e:typeof define=="function"&&define.amd&&define(e)}).call(A)});var M=W(I()),g,C,D,P,T;window.StoreConnect=window.StoreConnect||{};function L(d,e,r,l,n){g=d,C=e,P=r,T=l,D=n,E().addEventListener("submit",Z,!1)}function _(){return D?`${C}Product${D}`:C}function $(){return document.getElementById(`${g}PaymentError${_()}`)}function V(){return document.getElementById(`${g}ScriptBlock${_()}`)}function E(){return document.getElementById(`${g}PaymentForm${_()}`)}function Y(){return document.getElementById(`${g}PaymentButton${C}`)}async function F({url:d,onload:e,id:r}){let l=document.createElement("script");l.src=d,e&&(l.onload=e),r&&(l.id=r),V().appendChild(l)}function k(d){let e=Y();if(T){T(e,d);return}e&&(d?(e.removeAttribute("data-loading"),e.disabled=!1,setTimeout(()=>{e.disabled=!1},500)):(e.setAttribute("data-loading",!0),e.disabled=!0))}function j(d,e=!0){let r=$();r?(e&&(r.innerText=d),d&&r.classList.remove("sc-hide")):(console.warn(g?`Provider '${g}' does not have a #${g}PaymentError${C} div container`:"Run init(providerName, providerId) before calling showError(error)"),console.error(d)),k(!0)}function H(){$().classList.add("sc-hide")}function Z(d){d.preventDefault(),ee(()=>{P&&P(E())})}function ee(d){k(!1),document.dispatchEvent(new CustomEvent("store-connect.payment-processing-start")),d()}function q({payload:d,handleSuccess:e}){H();let r=E();d.payment=d.payment||{},d.payment.provider_id=C,d.payment.method=g;let l=document.getElementById(`_checkout_customer_notes_${C}`);l&&(d.customer_notes=l.value);let n=document.getElementById(`_checkout_assisted_by_user_id_${C}`);n&&(d.assisted_by_user_id=n.value);let i=new FormData(r);d.answers={},i.forEach((u,t)=>{let s=t.match(/answers\[(.*)\]\[answer\]/);s&&(d.answers[s[1]]={answer:u})});let o=r._method?r._method.value:r.getAttribute("method"),p=d.url?d.url:r.getAttribute("action");M.default.ajax({url:p,type:o||d.method,beforeSend(u,t){return u.setRequestHeader("Content-Type","application/json; charset=UTF-8"),t.data=JSON.stringify(d),!0},success:function(u,t,s){u.sf?window.parent.postMessage({type:"payment_status",status:"success",message:u.paymentId},"*"):u.redirect_url?window.location=u.redirect_url:u.error_message?te(u.error_message):u.payment_response&&e&&e(u.payment_response.action)},error:function(u,t,s){if(s.status===0)return;let c=document.querySelector("[data-general-error-message]");c&&j(c.getAttribute("data-general-error-message"))}})}function te(d){d?j(d):H(),k(!0)}function B(){let d=E();return d?d.dataset.apiKey:null}function N(){let d=E();return d?d.dataset.apiMode:null}window.StoreConnect=window.StoreConnect||{};window.StoreConnect.Gateways=window.StoreConnect.Gateways||{};window.StoreConnect.Gateways.SecurePay=function({providerId:d,inputStyles:e}){var r;L("SecurePay",d,function(){r.tokenise()});let l=`SecurePayScript${d}`;var n="https://payments.auspost.net.au/v3/ui/client/securepay-ui.min.js";N()!=="production"&&(n="https://payments-stest.npe.auspost.zone/v3/ui/client/securepay-ui.min.js"),F({url:n,id:l,onload:function(){let i=E().dataset.merchantCode;k(!1);function o(s){let c={payment_source:{tok_id:s.token}};q({payload:c})}function p(s){let c=JSON.parse(s).errors[0].detail;j(c)}function u(){E().getElementsByClassName("securepay-ui-iframe")[0].classList.add("sc-border-none")}function t(){u(),k(!0)}r=new securePayUI.init({containerId:`SecurePayContainer${d}`,scriptId:l,clientId:B(),merchantCode:i,card:{onTokeniseSuccess:o,onTokenizeError:p},style:e,onLoadComplete:t})}})};})();
