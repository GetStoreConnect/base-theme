(()=>{var U=Object.create;var I=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var Q=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var W=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports);var V=(l,e,r,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of K(e))!J.call(l,t)&&t!==r&&I(l,t,{get:()=>e[t],enumerable:!(u=z(e,t))||u.enumerable});return l};var Y=(l,e,r)=>(r=l!=null?U(Q(l)):{},V(e||!l||!l.__esModule?I(r,"default",{value:l,enumerable:!0}):r,l));var M=W((A,k)=>{(function(){var l=this;(function(){(function(){this.Rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:{selector:"button[data-remote]:not([form]), button[data-confirm]:not([form])",exclude:"form button"},inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form:not([data-turbo=true])",formInputClickSelector:"form:not([data-turbo=true]) input[type=submit], form:not([data-turbo=true]) input[type=image], form:not([data-turbo=true]) button[type=submit], form:not([data-turbo=true]) button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",formDisableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",formEnableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]"}}).call(this)}).call(l);var e=l.Rails;(function(){(function(){var r;r=null,e.loadCSPNonce=function(){var u;return r=(u=document.querySelector("meta[name=csp-nonce]"))!=null?u.content:void 0},e.cspNonce=function(){return r??e.loadCSPNonce()}}).call(this),function(){var r,u;u=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector,e.matches=function(t,i){return i.exclude!=null?u.call(t,i.selector)&&!u.call(t,i.exclude):u.call(t,i)},r="_ujsData",e.getData=function(t,i){var a;return(a=t[r])!=null?a[i]:void 0},e.setData=function(t,i,a){return t[r]==null&&(t[r]={}),t[r][i]=a},e.$=function(t){return Array.prototype.slice.call(document.querySelectorAll(t))}}.call(this),function(){var r,u,t;r=e.$,t=e.csrfToken=function(){var i;return i=document.querySelector("meta[name=csrf-token]"),i&&i.content},u=e.csrfParam=function(){var i;return i=document.querySelector("meta[name=csrf-param]"),i&&i.content},e.CSRFProtection=function(i){var a;if(a=t(),a!=null)return i.setRequestHeader("X-CSRF-Token",a)},e.refreshCSRFTokens=function(){var i,a;if(a=t(),i=u(),a!=null&&i!=null)return r('form input[name="'+i+'"]').forEach(function(m){return m.value=a})}}.call(this),function(){var r,u,t,i;t=e.matches,r=window.CustomEvent,typeof r!="function"&&(r=function(a,m){var c;return c=document.createEvent("CustomEvent"),c.initCustomEvent(a,m.bubbles,m.cancelable,m.detail),c},r.prototype=window.Event.prototype,i=r.prototype.preventDefault,r.prototype.preventDefault=function(){var a;return a=i.call(this),this.cancelable&&!this.defaultPrevented&&Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}}),a}),u=e.fire=function(a,m,c){var n;return n=new r(m,{bubbles:!0,cancelable:!0,detail:c}),a.dispatchEvent(n),!n.defaultPrevented},e.stopEverything=function(a){return u(a.target,"ujs:everythingStopped"),a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation()},e.delegate=function(a,m,c,n){return a.addEventListener(c,function(d){var s;for(s=d.target;!(!(s instanceof Element)||t(s,m));)s=s.parentNode;if(s instanceof Element&&n.call(s,d)===!1)return d.preventDefault(),d.stopPropagation()})}}.call(this),function(){var r,u,t,i,a,m,c;i=e.cspNonce,u=e.CSRFProtection,a=e.fire,r={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},e.ajax=function(n){var d;if(n=m(n),d=t(n,function(){var s,b;return b=c((s=d.response)!=null?s:d.responseText,d.getResponseHeader("Content-Type")),Math.floor(d.status/100)===2?typeof n.success=="function"&&n.success(b,d.statusText,d):typeof n.error=="function"&&n.error(b,d.statusText,d),typeof n.complete=="function"?n.complete(d,d.statusText):void 0}),n.beforeSend!=null&&!n.beforeSend(d,n))return!1;if(d.readyState===XMLHttpRequest.OPENED)return d.send(n.data)},m=function(n){return n.url=n.url||location.href,n.type=n.type.toUpperCase(),n.type==="GET"&&n.data&&(n.url.indexOf("?")<0?n.url+="?"+n.data:n.url+="&"+n.data),r[n.dataType]==null&&(n.dataType="*"),n.accept=r[n.dataType],n.dataType!=="*"&&(n.accept+=", */*; q=0.01"),n},t=function(n,d){var s;return s=new XMLHttpRequest,s.open(n.type,n.url,!0),s.setRequestHeader("Accept",n.accept),typeof n.data=="string"&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.crossDomain||(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),u(s)),s.withCredentials=!!n.withCredentials,s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)return d(s)},s},c=function(n,d){var s,b;if(typeof n=="string"&&typeof d=="string"){if(d.match(/\bjson\b/))try{n=JSON.parse(n)}catch{}else if(d.match(/\b(?:java|ecma)script\b/))b=document.createElement("script"),b.setAttribute("nonce",i()),b.text=n,document.head.appendChild(b).parentNode.removeChild(b);else if(d.match(/\b(xml|html|svg)\b/)){s=new DOMParser,d=d.replace(/;.+/,"");try{n=s.parseFromString(n,d)}catch{}}}return n},e.href=function(n){return n.href},e.isCrossDomain=function(n){var d,s,b;s=document.createElement("a"),s.href=location.href,b=document.createElement("a");try{return b.href=n,!((!b.protocol||b.protocol===":")&&!b.host||s.protocol+"//"+s.host==b.protocol+"//"+b.host)}catch(h){return d=h,!0}}}.call(this),function(){var r,u;r=e.matches,u=function(t){return Array.prototype.slice.call(t)},e.serializeElement=function(t,i){var a,m;return a=[t],r(t,"form")&&(a=u(t.elements)),m=[],a.forEach(function(c){if(!(!c.name||c.disabled)&&!r(c,"fieldset[disabled] *")){if(r(c,"select"))return u(c.options).forEach(function(n){if(n.selected)return m.push({name:c.name,value:n.value})});if(c.checked||["radio","checkbox","submit"].indexOf(c.type)===-1)return m.push({name:c.name,value:c.value})}}),i&&m.push(i),m.map(function(c){return c.name!=null?encodeURIComponent(c.name)+"="+encodeURIComponent(c.value):c}).join("&")},e.formElements=function(t,i){return r(t,"form")?u(t.elements).filter(function(a){return r(a,i)}):u(t.querySelectorAll(i))}}.call(this),function(){var r,u,t;u=e.fire,t=e.stopEverything,e.handleConfirm=function(i){if(!r(this))return t(i)},e.confirm=function(i,a){return confirm(i)},r=function(i){var a,m,c;if(c=i.getAttribute("data-confirm"),!c)return!0;if(a=!1,u(i,"confirm")){try{a=e.confirm(c,i)}catch{}m=u(i,"confirm:complete",[a])}return a&&m}}.call(this),function(){var r,u,t,i,a,m,c,n,d,s,b,h;s=e.matches,n=e.getData,b=e.setData,h=e.stopEverything,c=e.formElements,e.handleDisabledElement=function(o){var f;if(f=this,f.disabled)return h(o)},e.enableElement=function(o){var f;if(o instanceof Event){if(d(o))return;f=o.target}else f=o;if(s(f,e.linkDisableSelector))return m(f);if(s(f,e.buttonDisableSelector)||s(f,e.formEnableSelector))return i(f);if(s(f,e.formSubmitSelector))return a(f)},e.disableElement=function(o){var f;if(f=o instanceof Event?o.target:o,s(f,e.linkDisableSelector))return t(f);if(s(f,e.buttonDisableSelector)||s(f,e.formDisableSelector))return r(f);if(s(f,e.formSubmitSelector))return u(f)},t=function(o){var f;if(!n(o,"ujs:disabled"))return f=o.getAttribute("data-disable-with"),f!=null&&(b(o,"ujs:enable-with",o.innerHTML),o.innerHTML=f),o.addEventListener("click",h),b(o,"ujs:disabled",!0)},m=function(o){var f;return f=n(o,"ujs:enable-with"),f!=null&&(o.innerHTML=f,b(o,"ujs:enable-with",null)),o.removeEventListener("click",h),b(o,"ujs:disabled",null)},u=function(o){return c(o,e.formDisableSelector).forEach(r)},r=function(o){var f;if(!n(o,"ujs:disabled"))return f=o.getAttribute("data-disable-with"),f!=null&&(s(o,"button")?(b(o,"ujs:enable-with",o.innerHTML),o.innerHTML=f):(b(o,"ujs:enable-with",o.value),o.value=f)),o.disabled=!0,b(o,"ujs:disabled",!0)},a=function(o){return c(o,e.formEnableSelector).forEach(i)},i=function(o){var f;return f=n(o,"ujs:enable-with"),f!=null&&(s(o,"button")?o.innerHTML=f:o.value=f,b(o,"ujs:enable-with",null)),o.disabled=!1,b(o,"ujs:disabled",null)},d=function(o){var f,p;return p=(f=o.detail)!=null?f[0]:void 0,p?.getResponseHeader("X-Xhr-Redirect")!=null}}.call(this),function(){var r;r=e.stopEverything,e.handleMethod=function(u){var t,i,a,m,c,n,d;if(n=this,d=n.getAttribute("data-method"),!!d)return c=e.href(n),i=e.csrfToken(),t=e.csrfParam(),a=document.createElement("form"),m="<input name='_method' value='"+d+"' type='hidden' />",t!=null&&i!=null&&!e.isCrossDomain(c)&&(m+="<input name='"+t+"' value='"+i+"' type='hidden' />"),m+='<input type="submit" />',a.method="post",a.action=c,a.target=n.target,a.innerHTML=m,a.style.display="none",document.body.appendChild(a),a.querySelector('[type="submit"]').click(),r(u)}}.call(this),function(){var r,u,t,i,a,m,c,n,d,s=[].slice;m=e.matches,t=e.getData,n=e.setData,u=e.fire,d=e.stopEverything,r=e.ajax,i=e.isCrossDomain,c=e.serializeElement,a=function(b){var h;return h=b.getAttribute("data-remote"),h!=null&&h!=="false"},e.handleRemote=function(b){var h,o,f,p,y,v,w;return p=this,a(p)?u(p,"ajax:before")?(w=p.getAttribute("data-with-credentials"),f=p.getAttribute("data-type")||"script",m(p,e.formSubmitSelector)?(h=t(p,"ujs:submit-button"),y=t(p,"ujs:submit-button-formmethod")||p.method,v=t(p,"ujs:submit-button-formaction")||p.getAttribute("action")||location.href,y.toUpperCase()==="GET"&&(v=v.replace(/\?.*$/,"")),p.enctype==="multipart/form-data"?(o=new FormData(p),h!=null&&o.append(h.name,h.value)):o=c(p,h),n(p,"ujs:submit-button",null),n(p,"ujs:submit-button-formmethod",null),n(p,"ujs:submit-button-formaction",null)):m(p,e.buttonClickSelector)||m(p,e.inputChangeSelector)?(y=p.getAttribute("data-method"),v=p.getAttribute("data-url"),o=c(p,p.getAttribute("data-params"))):(y=p.getAttribute("data-method"),v=e.href(p),o=p.getAttribute("data-params")),r({type:y||"GET",url:v,data:o,dataType:f,beforeSend:function(g,X){return u(p,"ajax:beforeSend",[g,X])?u(p,"ajax:send",[g]):(u(p,"ajax:stopped"),!1)},success:function(){var g;return g=1<=arguments.length?s.call(arguments,0):[],u(p,"ajax:success",g)},error:function(){var g;return g=1<=arguments.length?s.call(arguments,0):[],u(p,"ajax:error",g)},complete:function(){var g;return g=1<=arguments.length?s.call(arguments,0):[],u(p,"ajax:complete",g)},crossDomain:i(v),withCredentials:w!=null&&w!=="false"}),d(b)):(u(p,"ajax:stopped"),!1):!0},e.formSubmitButtonClick=function(b){var h,o;if(h=this,o=h.form,!!o)return h.name&&n(o,"ujs:submit-button",{name:h.name,value:h.value}),n(o,"ujs:formnovalidate-button",h.formNoValidate),n(o,"ujs:submit-button-formaction",h.getAttribute("formaction")),n(o,"ujs:submit-button-formmethod",h.getAttribute("formmethod"))},e.preventInsignificantClick=function(b){var h,o,f,p,y,v;if(f=this,y=(f.getAttribute("data-method")||"GET").toUpperCase(),h=f.getAttribute("data-params"),p=b.metaKey||b.ctrlKey,o=p&&y==="GET"&&!h,v=b.button!=null&&b.button!==0,v||o)return b.stopImmediatePropagation()}}.call(this),function(){var r,u,t,i,a,m,c,n,d,s,b,h,o,f,p;if(m=e.fire,t=e.delegate,n=e.getData,r=e.$,p=e.refreshCSRFTokens,u=e.CSRFProtection,o=e.loadCSPNonce,a=e.enableElement,i=e.disableElement,s=e.handleDisabledElement,d=e.handleConfirm,f=e.preventInsignificantClick,h=e.handleRemote,c=e.formSubmitButtonClick,b=e.handleMethod,typeof jQuery<"u"&&jQuery!==null&&jQuery.ajax!=null){if(jQuery.rails)throw new Error("If you load both jquery_ujs and rails-ujs, use rails-ujs only.");jQuery.rails=e,jQuery.ajaxPrefilter(function(y,v,w){if(!y.crossDomain)return u(w)})}e.start=function(){if(window._rails_loaded)throw new Error("rails-ujs has already been loaded!");return window.addEventListener("pageshow",function(){return r(e.formEnableSelector).forEach(function(y){if(n(y,"ujs:disabled"))return a(y)}),r(e.linkDisableSelector).forEach(function(y){if(n(y,"ujs:disabled"))return a(y)})}),t(document,e.linkDisableSelector,"ajax:complete",a),t(document,e.linkDisableSelector,"ajax:stopped",a),t(document,e.buttonDisableSelector,"ajax:complete",a),t(document,e.buttonDisableSelector,"ajax:stopped",a),t(document,e.linkClickSelector,"click",f),t(document,e.linkClickSelector,"click",s),t(document,e.linkClickSelector,"click",d),t(document,e.linkClickSelector,"click",i),t(document,e.linkClickSelector,"click",h),t(document,e.linkClickSelector,"click",b),t(document,e.buttonClickSelector,"click",f),t(document,e.buttonClickSelector,"click",s),t(document,e.buttonClickSelector,"click",d),t(document,e.buttonClickSelector,"click",i),t(document,e.buttonClickSelector,"click",h),t(document,e.inputChangeSelector,"change",s),t(document,e.inputChangeSelector,"change",d),t(document,e.inputChangeSelector,"change",h),t(document,e.formSubmitSelector,"submit",s),t(document,e.formSubmitSelector,"submit",d),t(document,e.formSubmitSelector,"submit",h),t(document,e.formSubmitSelector,"submit",function(y){return setTimeout(function(){return i(y)},13)}),t(document,e.formSubmitSelector,"ajax:send",i),t(document,e.formSubmitSelector,"ajax:complete",a),t(document,e.formInputClickSelector,"click",f),t(document,e.formInputClickSelector,"click",s),t(document,e.formInputClickSelector,"click",d),t(document,e.formInputClickSelector,"click",c),document.addEventListener("DOMContentLoaded",p),document.addEventListener("DOMContentLoaded",o),window._rails_loaded=!0},window.Rails===e&&m(document,"rails:attachBindings")&&e.start()}.call(this)}).call(this),typeof k=="object"&&k.exports?k.exports=e:typeof define=="function"&&define.amd&&define(e)}).call(A)});var q=Y(M()),E,C,j,D,_;window.StoreConnect=window.StoreConnect||{};function L(l,e,r,u,t){E=l,C=e,D=r,_=u,j=t,S().addEventListener("submit",ee,!1)}function $(){return j?`${C}Product${j}`:C}function B(){return document.getElementById(`${E}PaymentError${$()}`)}function S(){return document.getElementById(`${E}PaymentForm${$()}`)}function Z(){return document.getElementById(`${E}PaymentButton${C}`)}function R(l){let e=Z();if(_){_(e,l);return}e&&(l?(e.removeAttribute("data-loading"),e.disabled=!1,setTimeout(()=>{e.disabled=!1},500)):(e.setAttribute("data-loading",!0),e.disabled=!0))}function x(l,e=!0){let r=B();r?(e&&(r.innerText=l),l&&r.classList.remove("sc-hide")):(console.warn(E?`Provider '${E}' does not have a #${E}PaymentError${C} div container`:"Run init(providerName, providerId) before calling showError(error)"),console.error(l)),R(!0)}function H(){B()?.classList.add("sc-hide")}function ee(l){l.preventDefault(),te(()=>{D&&D(S())})}function te(l){R(!1),document.dispatchEvent(new CustomEvent("store-connect.payment-processing-start")),l()}function T({payload:l,handleSuccess:e}){H();let r=S();l.payment=l.payment||{},l.payment.provider_id=C,l.payment.method=E;let u=document.getElementById(`_checkout_customer_notes_${C}`);u&&(l.customer_notes=u.value);let t=document.getElementById(`_checkout_assisted_by_user_id_${C}`);t&&(l.assisted_by_user_id=t.value);let i=new FormData(r);l.answers={},i.forEach((c,n)=>{let d=n.match(/answers\[(.*)\]\[answer\]/);d&&(l.answers[d[1]]={answer:c})});let a=r._method?r._method.value:r.getAttribute("method"),m=l.url?l.url:r.getAttribute("action");q.default.ajax({url:m,type:a||l.method,beforeSend(c,n){return c.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.data=JSON.stringify(l),!0},success:function(c,n,d){c.sf?window.parent.postMessage({type:"payment_status",status:"success",message:c.paymentId},"*"):c.redirect_url?window.location=c.redirect_url:c.error_message?ne(c.error_message):c.payment_response&&e&&e(c.payment_response.action)},error:function(c,n,d){if(d.status===0)return;let s=document.querySelector("[data-general-error-message]");s&&x(s.getAttribute("data-general-error-message"))}})}function ne(l){l?x(l):H(),R(!0)}function F(){let l=S();return l?l.dataset.apiKey:null}function P(){let l=S();return l?l.dataset.totalPayable:null}function N(){let l=S();return l?l.dataset.currencyCode:null}async function O(l,e,r){let u={amount:P(),billingContact:{givenName:r.firstname,familyName:r.lastname,email:r.email,phone:r.phone,addressLines:[r.billingStreet],city:r.billingCity,countryCode:r.billingCountry},currencyCode:r.currency,intent:"CHARGE"};return(await l.verifyBuyer(e,u)).token}async function G(l){let e=await l.tokenize();if(e.status==="OK")return e.token;{let r=`Tokenization failed with status: ${e.status}`;throw e.errors&&(r+=` and errors: ${JSON.stringify(e.errors)}`),new Error(r)}}async function re(l){try{let e=await G(card),r=await O(payments,e,data),u={payment_source:{locationId,tok_id:e,verification_token:r}};T({payload:u})}catch(e){console.error(e.message),x(null)}}window.StoreConnect=window.StoreConnect||{};window.StoreConnect.Gateways=window.StoreConnect.Gateways||{};window.StoreConnect.Gateways.SquareGoogle=function(l={providerId,billingStreet,billingCity,postCode,billingCountry,lastname,firstname,email,phone}){L("SquareGoogle",e,re);let e=l.providerId,r=l.billingCountry,u=S().dataset.locationId;document.addEventListener("DOMContentLoaded",async function(){if(!window.Square)throw new Error("Square.js failed to load properly");let t,i=F();try{t=window.Square.payments(i,u)}catch(a){Bugsnag.notify(a);let m=document.getElementById(`SquareGooglePaymentStatus${e}`);m.className="missing-credentials",m.style.visibility="visible";return}try{let a=t.paymentRequest({countryCode:r,currencyCode:N(),total:{amount:P(),label:"Total"}}),m=`SquareGooglePaymentButton${e}`,c=await t.googlePay(a);await c.attach(`#${m}`),document.getElementById(m).addEventListener("click",async function(n){n.preventDefault();let d=await G(c),s=await O(t,token,l);T({payload:{payment_source:{tok_id:d,verification_token:s}}})})}catch(a){console.error("Initializing Google Pay failed",a)}})};})();
