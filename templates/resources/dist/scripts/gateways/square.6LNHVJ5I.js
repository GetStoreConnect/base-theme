(()=>{var Y=Object.create;var N=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var re=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var ae=(o,e,a,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ee(e))!ne.call(o,n)&&n!==a&&N(o,n,{get:()=>e[n],enumerable:!(s=Z(e,n))||s.enumerable});return o};var oe=(o,e,a)=>(a=o!=null?Y(te(o)):{},ae(e||!o||!o.__esModule?N(a,"default",{value:o,enumerable:!0}):a,o));var O=re((F,j)=>{(function(){var o=this;(function(){(function(){this.Rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:{selector:"button[data-remote]:not([form]), button[data-confirm]:not([form])",exclude:"form button"},inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form:not([data-turbo=true])",formInputClickSelector:"form:not([data-turbo=true]) input[type=submit], form:not([data-turbo=true]) input[type=image], form:not([data-turbo=true]) button[type=submit], form:not([data-turbo=true]) button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",formDisableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",formEnableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]"}}).call(this)}).call(o);var e=o.Rails;(function(){(function(){var a;a=null,e.loadCSPNonce=function(){var s;return a=(s=document.querySelector("meta[name=csp-nonce]"))!=null?s.content:void 0},e.cspNonce=function(){return a??e.loadCSPNonce()}}).call(this),function(){var a,s;s=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector,e.matches=function(n,l){return l.exclude!=null?s.call(n,l.selector)&&!s.call(n,l.exclude):s.call(n,l)},a="_ujsData",e.getData=function(n,l){var i;return(i=n[a])!=null?i[l]:void 0},e.setData=function(n,l,i){return n[a]==null&&(n[a]={}),n[a][l]=i},e.$=function(n){return Array.prototype.slice.call(document.querySelectorAll(n))}}.call(this),function(){var a,s,n;a=e.$,n=e.csrfToken=function(){var l;return l=document.querySelector("meta[name=csrf-token]"),l&&l.content},s=e.csrfParam=function(){var l;return l=document.querySelector("meta[name=csrf-param]"),l&&l.content},e.CSRFProtection=function(l){var i;if(i=n(),i!=null)return l.setRequestHeader("X-CSRF-Token",i)},e.refreshCSRFTokens=function(){var l,i;if(i=n(),l=s(),i!=null&&l!=null)return a('form input[name="'+l+'"]').forEach(function(b){return b.value=i})}}.call(this),function(){var a,s,n,l;n=e.matches,a=window.CustomEvent,typeof a!="function"&&(a=function(i,b){var u;return u=document.createEvent("CustomEvent"),u.initCustomEvent(i,b.bubbles,b.cancelable,b.detail),u},a.prototype=window.Event.prototype,l=a.prototype.preventDefault,a.prototype.preventDefault=function(){var i;return i=l.call(this),this.cancelable&&!this.defaultPrevented&&Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}}),i}),s=e.fire=function(i,b,u){var t;return t=new a(b,{bubbles:!0,cancelable:!0,detail:u}),i.dispatchEvent(t),!t.defaultPrevented},e.stopEverything=function(i){return s(i.target,"ujs:everythingStopped"),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation()},e.delegate=function(i,b,u,t){return i.addEventListener(u,function(f){var d;for(d=f.target;!(!(d instanceof Element)||n(d,b));)d=d.parentNode;if(d instanceof Element&&t.call(d,f)===!1)return f.preventDefault(),f.stopPropagation()})}}.call(this),function(){var a,s,n,l,i,b,u;l=e.cspNonce,s=e.CSRFProtection,i=e.fire,a={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},e.ajax=function(t){var f;if(t=b(t),f=n(t,function(){var d,p;return p=u((d=f.response)!=null?d:f.responseText,f.getResponseHeader("Content-Type")),Math.floor(f.status/100)===2?typeof t.success=="function"&&t.success(p,f.statusText,f):typeof t.error=="function"&&t.error(p,f.statusText,f),typeof t.complete=="function"?t.complete(f,f.statusText):void 0}),t.beforeSend!=null&&!t.beforeSend(f,t))return!1;if(f.readyState===XMLHttpRequest.OPENED)return f.send(t.data)},b=function(t){return t.url=t.url||location.href,t.type=t.type.toUpperCase(),t.type==="GET"&&t.data&&(t.url.indexOf("?")<0?t.url+="?"+t.data:t.url+="&"+t.data),a[t.dataType]==null&&(t.dataType="*"),t.accept=a[t.dataType],t.dataType!=="*"&&(t.accept+=", */*; q=0.01"),t},n=function(t,f){var d;return d=new XMLHttpRequest,d.open(t.type,t.url,!0),d.setRequestHeader("Accept",t.accept),typeof t.data=="string"&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.crossDomain||(d.setRequestHeader("X-Requested-With","XMLHttpRequest"),s(d)),d.withCredentials=!!t.withCredentials,d.onreadystatechange=function(){if(d.readyState===XMLHttpRequest.DONE)return f(d)},d},u=function(t,f){var d,p;if(typeof t=="string"&&typeof f=="string"){if(f.match(/\bjson\b/))try{t=JSON.parse(t)}catch{}else if(f.match(/\b(?:java|ecma)script\b/))p=document.createElement("script"),p.setAttribute("nonce",l()),p.text=t,document.head.appendChild(p).parentNode.removeChild(p);else if(f.match(/\b(xml|html|svg)\b/)){d=new DOMParser,f=f.replace(/;.+/,"");try{t=d.parseFromString(t,f)}catch{}}}return t},e.href=function(t){return t.href},e.isCrossDomain=function(t){var f,d,p;d=document.createElement("a"),d.href=location.href,p=document.createElement("a");try{return p.href=t,!((!p.protocol||p.protocol===":")&&!p.host||d.protocol+"//"+d.host==p.protocol+"//"+p.host)}catch(h){return f=h,!0}}}.call(this),function(){var a,s;a=e.matches,s=function(n){return Array.prototype.slice.call(n)},e.serializeElement=function(n,l){var i,b;return i=[n],a(n,"form")&&(i=s(n.elements)),b=[],i.forEach(function(u){if(!(!u.name||u.disabled)&&!a(u,"fieldset[disabled] *")){if(a(u,"select"))return s(u.options).forEach(function(t){if(t.selected)return b.push({name:u.name,value:t.value})});if(u.checked||["radio","checkbox","submit"].indexOf(u.type)===-1)return b.push({name:u.name,value:u.value})}}),l&&b.push(l),b.map(function(u){return u.name!=null?encodeURIComponent(u.name)+"="+encodeURIComponent(u.value):u}).join("&")},e.formElements=function(n,l){return a(n,"form")?s(n.elements).filter(function(i){return a(i,l)}):s(n.querySelectorAll(l))}}.call(this),function(){var a,s,n;s=e.fire,n=e.stopEverything,e.handleConfirm=function(l){if(!a(this))return n(l)},e.confirm=function(l,i){return confirm(l)},a=function(l){var i,b,u;if(u=l.getAttribute("data-confirm"),!u)return!0;if(i=!1,s(l,"confirm")){try{i=e.confirm(u,l)}catch{}b=s(l,"confirm:complete",[i])}return i&&b}}.call(this),function(){var a,s,n,l,i,b,u,t,f,d,p,h;d=e.matches,t=e.getData,p=e.setData,h=e.stopEverything,u=e.formElements,e.handleDisabledElement=function(r){var c;if(c=this,c.disabled)return h(r)},e.enableElement=function(r){var c;if(r instanceof Event){if(f(r))return;c=r.target}else c=r;if(d(c,e.linkDisableSelector))return b(c);if(d(c,e.buttonDisableSelector)||d(c,e.formEnableSelector))return l(c);if(d(c,e.formSubmitSelector))return i(c)},e.disableElement=function(r){var c;if(c=r instanceof Event?r.target:r,d(c,e.linkDisableSelector))return n(c);if(d(c,e.buttonDisableSelector)||d(c,e.formDisableSelector))return a(c);if(d(c,e.formSubmitSelector))return s(c)},n=function(r){var c;if(!t(r,"ujs:disabled"))return c=r.getAttribute("data-disable-with"),c!=null&&(p(r,"ujs:enable-with",r.innerHTML),r.innerHTML=c),r.addEventListener("click",h),p(r,"ujs:disabled",!0)},b=function(r){var c;return c=t(r,"ujs:enable-with"),c!=null&&(r.innerHTML=c,p(r,"ujs:enable-with",null)),r.removeEventListener("click",h),p(r,"ujs:disabled",null)},s=function(r){return u(r,e.formDisableSelector).forEach(a)},a=function(r){var c;if(!t(r,"ujs:disabled"))return c=r.getAttribute("data-disable-with"),c!=null&&(d(r,"button")?(p(r,"ujs:enable-with",r.innerHTML),r.innerHTML=c):(p(r,"ujs:enable-with",r.value),r.value=c)),r.disabled=!0,p(r,"ujs:disabled",!0)},i=function(r){return u(r,e.formEnableSelector).forEach(l)},l=function(r){var c;return c=t(r,"ujs:enable-with"),c!=null&&(d(r,"button")?r.innerHTML=c:r.value=c,p(r,"ujs:enable-with",null)),r.disabled=!1,p(r,"ujs:disabled",null)},f=function(r){var c,m;return m=(c=r.detail)!=null?c[0]:void 0,m?.getResponseHeader("X-Xhr-Redirect")!=null}}.call(this),function(){var a;a=e.stopEverything,e.handleMethod=function(s){var n,l,i,b,u,t,f;if(t=this,f=t.getAttribute("data-method"),!!f)return u=e.href(t),l=e.csrfToken(),n=e.csrfParam(),i=document.createElement("form"),b="<input name='_method' value='"+f+"' type='hidden' />",n!=null&&l!=null&&!e.isCrossDomain(u)&&(b+="<input name='"+n+"' value='"+l+"' type='hidden' />"),b+='<input type="submit" />',i.method="post",i.action=u,i.target=t.target,i.innerHTML=b,i.style.display="none",document.body.appendChild(i),i.querySelector('[type="submit"]').click(),a(s)}}.call(this),function(){var a,s,n,l,i,b,u,t,f,d=[].slice;b=e.matches,n=e.getData,t=e.setData,s=e.fire,f=e.stopEverything,a=e.ajax,l=e.isCrossDomain,u=e.serializeElement,i=function(p){var h;return h=p.getAttribute("data-remote"),h!=null&&h!=="false"},e.handleRemote=function(p){var h,r,c,m,v,S,y;return m=this,i(m)?s(m,"ajax:before")?(y=m.getAttribute("data-with-credentials"),c=m.getAttribute("data-type")||"script",b(m,e.formSubmitSelector)?(h=n(m,"ujs:submit-button"),v=n(m,"ujs:submit-button-formmethod")||m.method,S=n(m,"ujs:submit-button-formaction")||m.getAttribute("action")||location.href,v.toUpperCase()==="GET"&&(S=S.replace(/\?.*$/,"")),m.enctype==="multipart/form-data"?(r=new FormData(m),h!=null&&r.append(h.name,h.value)):r=u(m,h),t(m,"ujs:submit-button",null),t(m,"ujs:submit-button-formmethod",null),t(m,"ujs:submit-button-formaction",null)):b(m,e.buttonClickSelector)||b(m,e.inputChangeSelector)?(v=m.getAttribute("data-method"),S=m.getAttribute("data-url"),r=u(m,m.getAttribute("data-params"))):(v=m.getAttribute("data-method"),S=e.href(m),r=m.getAttribute("data-params")),a({type:v||"GET",url:S,data:r,dataType:c,beforeSend:function(g,R){return s(m,"ajax:beforeSend",[g,R])?s(m,"ajax:send",[g]):(s(m,"ajax:stopped"),!1)},success:function(){var g;return g=1<=arguments.length?d.call(arguments,0):[],s(m,"ajax:success",g)},error:function(){var g;return g=1<=arguments.length?d.call(arguments,0):[],s(m,"ajax:error",g)},complete:function(){var g;return g=1<=arguments.length?d.call(arguments,0):[],s(m,"ajax:complete",g)},crossDomain:l(S),withCredentials:y!=null&&y!=="false"}),f(p)):(s(m,"ajax:stopped"),!1):!0},e.formSubmitButtonClick=function(p){var h,r;if(h=this,r=h.form,!!r)return h.name&&t(r,"ujs:submit-button",{name:h.name,value:h.value}),t(r,"ujs:formnovalidate-button",h.formNoValidate),t(r,"ujs:submit-button-formaction",h.getAttribute("formaction")),t(r,"ujs:submit-button-formmethod",h.getAttribute("formmethod"))},e.preventInsignificantClick=function(p){var h,r,c,m,v,S;if(c=this,v=(c.getAttribute("data-method")||"GET").toUpperCase(),h=c.getAttribute("data-params"),m=p.metaKey||p.ctrlKey,r=m&&v==="GET"&&!h,S=p.button!=null&&p.button!==0,S||r)return p.stopImmediatePropagation()}}.call(this),function(){var a,s,n,l,i,b,u,t,f,d,p,h,r,c,m;if(b=e.fire,n=e.delegate,t=e.getData,a=e.$,m=e.refreshCSRFTokens,s=e.CSRFProtection,r=e.loadCSPNonce,i=e.enableElement,l=e.disableElement,d=e.handleDisabledElement,f=e.handleConfirm,c=e.preventInsignificantClick,h=e.handleRemote,u=e.formSubmitButtonClick,p=e.handleMethod,typeof jQuery<"u"&&jQuery!==null&&jQuery.ajax!=null){if(jQuery.rails)throw new Error("If you load both jquery_ujs and rails-ujs, use rails-ujs only.");jQuery.rails=e,jQuery.ajaxPrefilter(function(v,S,y){if(!v.crossDomain)return s(y)})}e.start=function(){if(window._rails_loaded)throw new Error("rails-ujs has already been loaded!");return window.addEventListener("pageshow",function(){return a(e.formEnableSelector).forEach(function(v){if(t(v,"ujs:disabled"))return i(v)}),a(e.linkDisableSelector).forEach(function(v){if(t(v,"ujs:disabled"))return i(v)})}),n(document,e.linkDisableSelector,"ajax:complete",i),n(document,e.linkDisableSelector,"ajax:stopped",i),n(document,e.buttonDisableSelector,"ajax:complete",i),n(document,e.buttonDisableSelector,"ajax:stopped",i),n(document,e.linkClickSelector,"click",c),n(document,e.linkClickSelector,"click",d),n(document,e.linkClickSelector,"click",f),n(document,e.linkClickSelector,"click",l),n(document,e.linkClickSelector,"click",h),n(document,e.linkClickSelector,"click",p),n(document,e.buttonClickSelector,"click",c),n(document,e.buttonClickSelector,"click",d),n(document,e.buttonClickSelector,"click",f),n(document,e.buttonClickSelector,"click",l),n(document,e.buttonClickSelector,"click",h),n(document,e.inputChangeSelector,"change",d),n(document,e.inputChangeSelector,"change",f),n(document,e.inputChangeSelector,"change",h),n(document,e.formSubmitSelector,"submit",d),n(document,e.formSubmitSelector,"submit",f),n(document,e.formSubmitSelector,"submit",h),n(document,e.formSubmitSelector,"submit",function(v){return setTimeout(function(){return l(v)},13)}),n(document,e.formSubmitSelector,"ajax:send",l),n(document,e.formSubmitSelector,"ajax:complete",i),n(document,e.formInputClickSelector,"click",c),n(document,e.formInputClickSelector,"click",d),n(document,e.formInputClickSelector,"click",f),n(document,e.formInputClickSelector,"click",u),document.addEventListener("DOMContentLoaded",m),document.addEventListener("DOMContentLoaded",r),window._rails_loaded=!0},window.Rails===e&&b(document,"rails:attachBindings")&&e.start()}.call(this)}).call(this),typeof j=="object"&&j.exports?j.exports=e:typeof define=="function"&&define.amd&&define(e)}).call(F)});var z=oe(O()),E,k,q,A,I;window.StoreConnect=window.StoreConnect||{};function G(o,e,a,s,n){E=o,k=e,A=a,I=s,q=n,w().addEventListener("submit",le,!1)}function $(){return q?`${k}Product${q}`:k}function U(){return document.getElementById(`${E}PaymentError${$()}`)}function ie(){return document.getElementById(`${E}ScriptBlock${$()}`)}function w(){return document.getElementById(`${E}PaymentForm${$()}`)}function ce(){return document.getElementById(`${E}PaymentButton${k}`)}async function X({url:o,onload:e,id:a}){let s=document.createElement("script");s.src=o,e&&(s.onload=e),a&&(s.id=a),ie().appendChild(s)}function B(o){let e=ce();if(I){I(e,o);return}e&&(o?(e.removeAttribute("data-loading"),e.disabled=!1,setTimeout(()=>{e.disabled=!1},500)):(e.setAttribute("data-loading",!0),e.disabled=!0))}function D(o,e=!0){let a=U();a?(e&&(a.innerText=o),o&&a.classList.remove("sc-hide")):(console.warn(E?`Provider '${E}' does not have a #${E}PaymentError${k} div container`:"Run init(providerName, providerId) before calling showError(error)"),console.error(o)),B(!0)}function K(){U().classList.add("sc-hide")}function le(o){o.preventDefault(),ue(()=>{A&&A(w())})}function ue(o){B(!1),document.dispatchEvent(new CustomEvent("store-connect.payment-processing-start")),o()}function P({payload:o,handleSuccess:e}){K();let a=w();o.payment=o.payment||{},o.payment.provider_id=k,o.payment.method=E;let s=document.getElementById(`_checkout_customer_notes_${k}`);s&&(o.customer_notes=s.value);let n=document.getElementById(`_checkout_assisted_by_user_id_${k}`);n&&(o.assisted_by_user_id=n.value);let l=new FormData(a);o.answers={},l.forEach((u,t)=>{let f=t.match(/answers\[(.*)\]\[answer\]/);f&&(o.answers[f[1]]={answer:u})});let i=a._method?a._method.value:a.getAttribute("method"),b=o.url?o.url:a.getAttribute("action");z.default.ajax({url:b,type:i||o.method,beforeSend(u,t){return u.setRequestHeader("Content-Type","application/json; charset=UTF-8"),t.data=JSON.stringify(o),!0},success:function(u,t,f){u.sf?window.parent.postMessage({type:"payment_status",status:"success",message:u.paymentId},"*"):u.redirect_url?window.location=u.redirect_url:u.error_message?se(u.error_message):u.payment_response&&e&&e(u.payment_response.action)},error:function(u,t,f){if(f.status===0)return;let d=document.querySelector("[data-general-error-message]");d&&D(d.getAttribute("data-general-error-message"))}})}function se(o){o?D(o):K(),B(!0)}function Q(){let o=w();return o?o.dataset.apiKey:null}function W(){let o=w();return o?o.dataset.apiMode:null}function J(){let o=w();return o?!!o.dataset.showWallets:!1}function M(){let o=w();return o?o.dataset.totalPayable:null}function L(){let o=w();return o?o.dataset.currencyCode:null}window.StoreConnect=window.StoreConnect||{};window.StoreConnect.Gateways=window.StoreConnect.Gateways||{};window.StoreConnect.Gateways.Square=async function({providerId:o,firstname:e,lastname:a,email:s,phone:n,billingStreet:l,billingCity:i,billingCountry:b}){G("Square",o,d);let u,t;async function f(r){let c=await r.tokenize();if(c.status==="OK")return c.token;throw new Error(`Tokenization errors: ${JSON.stringify(c.errors)}`)}async function d(){try{let r=await f(u),c=await p(t,r);P({payload:{payment_source:{tok_id:r,verification_token:c}}})}catch(r){console.error(r.message),D(null)}}async function p(r,c){let m={amount:M(),billingContact:{givenName:e,familyName:a,email:s,phone:n,addressLines:[l],city:i,country:b},currencyCode:L(),intent:"CHARGE"};return(await r.verifyBuyer(c,m)).token}var h="https://web.squarecdn.com/v1/square.js";W()!=="production"&&(h="https://sandbox.web.squarecdn.com/v1/square.js"),X({url:h,onload:async function(){if(!window.Square)throw new Error("Square.js failed to load properly");let r=Q(),c=w().dataset.locationId;try{window.mockSquare?t=window.mockSquare.payments(r,c):t=window.Square.payments(r,c)}catch(y){Bugsnag.notify(y);let g=document.getElementById(`SquarePaymentStatus${o}`);g.className="missing-credentials",g.style.visibility="visible";return}try{u=await m(t)}catch(y){console.error("Square: Initializing Card failed",y);return}async function m(y){let g=await y.card();return await g.attach(`#SquarePaymentFields${o}`),g}function v(y){return y.paymentRequest({countryCode:b,currencyCode:L(),total:{amount:M(),label:"Total"}})}async function S(y){let g=v(y);return y.applePay(g)}if(J()){let y=`SquareGooglePaymentButton${o}`;if(document.getElementById(y)&&document.querySelector(`#${y}`))try{let x=v(t),_=await t.googlePay(x);await _.attach(`#${y}`),document.getElementById(y).addEventListener("click",async function(T){T.preventDefault();let H=await f(_),V=await p(t,H);P({payload:{payment_source:{tok_id:H,verification_token:V}}})})}catch(x){console.error("Initializing Google Pay failed",x)}let g=navigator.userAgent,R=g.includes("Safari")&&!g.includes("Chrome"),C=document.getElementById(`SquareApplePaymentButton${o}`);if(C)if(window.mockSquare||R)try{let x=await S(t);C.addEventListener("click",async()=>{let T={payment_source:{tok_id:(await x.tokenize()).token}};P({payload:T})})}catch(x){console.error("Initializing Apple Pay failed",x),C.parentNode.removeChild(C)}else C&&C.parentNode.removeChild(C)}else{let y=document.getElementById(`SquareWalletsContainer${o}`);y&&y.remove()}}})};})();
